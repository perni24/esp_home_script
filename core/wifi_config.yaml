substitutions:
  wifi_ssid: ""
  wifi_password: ""
  # esegue la connessione veloce senza fare la scansione di tutta la rete
  wifi_fast_connect: "true"
  # puÃ² avere tre valori (none, light, high) serve per ridurre il consumo energetico del wifi (utile per dispositivi a batteria)
  wifi_power_save_mode: "none" 
  wifi_reboot_timeout: "15min" 
  # tempo di attesa per avviare l'hotspot di emergenza
  wifi_ap_timeout: "1min"
  wifi_ap_password: ""
  ota_password: ""

ota:
  - platform: esphome
    password: ${ota_password}

wifi:
  ssid: ${wifi_ssid}
  password: ${wifi_password}
  fast_connect: ${wifi_fast_connect}
  power_save_mode: ${wifi_power_save_mode}
  reboot_timeout: ${wifi_reboot_timeout}
  ap:
    # device name Ã¨ una variabile di sistema generata in automatico
    ssid: "Fallback-Hotspot-${name}"
    password: ${wifi_ap_password}
    ap_timeout: ${wifi_ap_timeout}

captive_portal:

sensor:
  - platform: wifi_signal
    name: "WiFi Signal"
    id: wifi_dbm
    update_interval: 60s

text_sensor:
  - platform: template
    name: "WiFi Quality"
    lambda: |-
      if (std::isnan(id(wifi_dbm).state)) return {"In attesa..."}
      if (id(wifi_dbm).state > -50) return {"Eccellente"};
      if (id(wifi_dbm).state > -60) return {"Ottimo"};
      if (id(wifi_dbm).state > -70) return {"Buono"};
      if (id(wifi_dbm).state > -80) return {"Scarso"};
      return {"Pessimo"};
    update_interval: 60s